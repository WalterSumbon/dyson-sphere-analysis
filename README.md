# dyson-sphere-analysis

这是一个用来自动分析游戏“戴森球计划”中生产与供应需求的python程序。

## prerequisite
安装pydot库和graphviz。
代码只在linux系统上正常工作。

## 使用

本代码提供有两个工具类：
`SynthesisManual`和`SynthesisGraph`。
主要的功能就是从一个文件中读取合成公式的数据，然后对于特定的合成目标，每种涉及到的物质分别需要多大的合成速率和多少个生产站(制造台、粒子对撞机、矿脉数等)

### 使用示例
```python
syn_man = SynthesisManual('data.txt')
syn_graph = SynthesisGraph(['电磁矩阵','能量矩阵','结构矩阵','信息矩阵','引力矩阵'], [60,60,60,60,60], syn_man)
syn_graph.dump()
```

上述代码中：
+ 第一行从`data.txt`文件中读入合成公式来初始化一个`SynthesisManual`。
+ 第二行指定合成的目标产物和对应需要的生产速率(单位：个/分钟)和`SynthesisManual`来初始化一个`SynthesisGraph`。
+ 第三行将合成图导出到一个png格式的文件中。可以指定文件名，如果不指定的话会由程序来自动生成一个文件名。

其中用来描述合成公式的`data.txt`文件遵循以下格式：
+ 注释以`;`开头。
+ 每行只能有一个合成公式。公式的第一项为产物，后面的项为原料，最后结尾的数字是所需的时间(单位：s)。
例如：
	+ `4 钛合金 4 钛块 4 钢材 8 硫酸 12`表示4个钛合金由4个钛块+4个钢材+8个硫酸经12s合成。
	+ `42 铁矿 60`表示42个铁矿需要60s才能开采出来，即一个矿脉的开采速度为42/min。
数字和汉字之间要有空白字符分隔，支持浮点数。
+ 暂不支持多产物公式的计算（以后可能会添加支持）
+ 对于同一种物质，只能有一个以其为产物的合成公式。

仓库中的`data.txt`已经提供了目前版本的游戏中所有符合上述条件的合成公式，可以根据需要自行选用。

## 程序输出

![example output](img\电磁矩阵_能量矩阵_结构矩阵_信息矩阵_引力矩阵_9290.png)

这张图中给出了如果需要五种基础矩阵均以60个/min的速度生产的话所需的每种中间原料的生产速度和需要的生产站的数目。

绿色的圆圈表示基础原料，红色的表示没有给出合成公式的物质，黄色的表示最终的目标产物。